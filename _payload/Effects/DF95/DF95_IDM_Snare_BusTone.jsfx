desc: DF95 IDM Snare Bus Tone
author: DF95
version: 1.0

slider1:120<60,250,1>HPF (Hz)
slider2:200<150,350,1>Body freq (Hz)
slider3:3<0,8,0.1>Body boost (dB)
slider4:6000<3000,9000,10>Snap freq (Hz)
slider5:3<0,8,0.1>Snap boost (dB)
slider6:0.2<0,1,0.01>Saturation

@init
two_pi = 2*$pi;
hp_l = 0; hp_r = 0;
body_l = 0; body_r = 0;
snap_l = 0; snap_r = 0;

@slider
hpf_f   = slider1;
body_f  = slider2;
body_g  = 10^(slider3/20);
snap_f  = slider4;
snap_g  = 10^(slider5/20);
sat_amt = slider6;

hpf_wc   = two_pi*hpf_f/srate;
hpf_a    = hpf_wc/(hpf_wc+1);
body_wc  = two_pi*body_f/srate;
body_a   = body_wc/(body_wc+1);
snap_wc  = two_pi*snap_f/srate;
snap_a   = snap_wc/(snap_wc+1);

@sample
in_l = spl0;
in_r = spl1;

hp_l += hpf_a*(in_l-hp_l);
hp_r += hpf_a*(in_r-hp_r);
l = in_l - hp_l;
r = in_r - hp_r;

body_l += body_a*(l-body_l);
body_r += body_a*(r-body_r);

snap_l += snap_a*(l-snap_l);
snap_r += snap_a*(r-snap_r);

l = l + (body_l-l)*(body_g-1);
r = r + (body_r-r)*(body_g-1);

l = l + (snap_l-l)*(snap_g-1);
r = r + (snap_r-r)*(snap_g-1);

l = tanh(l*(1+sat_amt*4));
r = tanh(r*(1+sat_amt*4));

spl0 = l;
spl1 = r;
